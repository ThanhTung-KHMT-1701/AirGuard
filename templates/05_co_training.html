{% extends "base.html" %}

{% block title %}Co-training - AirGuard{% endblock %}

{% block content %}
<div class="container">
    <h2>05. Co-training</h2>
    
    <div style="margin: 2em 0;">
        <h3>Tổng quan</h3>
        <p style="font-size: 1.05em; line-height: 1.8;">
            Co-training là phương pháp Semi-supervised Learning sử dụng hai mô hình được huấn luyện trên 
            hai tập đặc trưng độc lập. Mỗi mô hình dự đoán nhãn cho dữ liệu chưa có nhãn với độ tin cậy cao 
            và chia sẻ với mô hình kia để cùng cải thiện.
        </p>
    </div>

    {% if data.metrics %}
    <div style="margin: 2em 0;">
        <h3>Kết quả đánh giá</h3>
        <div class="metrics-grid">
            {% for key, value in data.metrics.items() %}
            <div class="metric-card">
                <h4>{{ key.replace('_', ' ').title() }}</h4>
                {% if value is number %}
                    <div class="value">
                        {{ "%.4f"|format(value) }}
                    </div>
                {% else %}
                    {# Đối với chuỗi JSON, dicts, lists - sử dụng preformatted text #}
                    <pre class="metric-pre"><code>{{ value | pretty_json }}</code></pre>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    {% if data.images.dynamics %}
    <div class="image-container">
        <h3>Quá trình Co-training</h3>
        <img src="{{ data.images.dynamics }}" alt="Co-training Dynamics">
        <p class="image-caption">Sự thay đổi của các chỉ số qua các vòng lặp Co-training</p>
    </div>
    {% endif %}

    {% if data.predictions_sample is not none %}
    <div style="margin: 2em 0;">
        <h3>Mẫu dự đoán (10 dòng đầu)</h3>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        {% for col in data.predictions_sample.columns %}
                        <th>{{ col }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for _, row in data.predictions_sample.iterrows() %}
                    <tr>
                        {% for val in row %}
                        <td>{{ "%.4f"|format(val) if val is number else val }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}

    {% if data.alerts_sample is not none %}
    <div style="margin: 2em 0;">
        <h3>Cảnh báo chất lượng không khí (10 cảnh báo đầu)</h3>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        {% for col in data.alerts_sample.columns %}
                        <th>{{ col }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for _, row in data.alerts_sample.iterrows() %}
                    <tr>
                        {% for val in row %}
                        <td>{{ "%.2f"|format(val) if val is number else val }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}

    <div style="margin: 3em 0; padding: 2em; background-color: #f8f9fa; border-radius: 12px; border-left: 5px solid #1FD2FF; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
        <h3 style="margin-top: 0;">Ưu điểm của Co-training</h3>
        <ul style="line-height: 2; font-size: 1.05em; padding-left: 1.5em;">
            <li>Tận dụng hai quan điểm khác nhau từ hai tập đặc trưng</li>
            <li>Giảm thiểu sai số so với Self-training đơn lẻ</li>
            <li>Hiệu quả khi có đặc trưng có thể chia thành hai nhóm độc lập</li>
            <li>Cải thiện tính tổng quát của mô hình</li>
        </ul>
    </div>
</div>
{% endblock %}
